<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NSU CGPA Calculator</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 20px;
}
.container {
  max-width: 900px;
  margin: auto;
  background: white;
  padding: 20px;
  border-radius: 8px;
}
h2 { margin-top: 0; }
button {
  padding: 8px 14px;
  cursor: pointer;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}
.modal {
  display: none;
  position: fixed;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.4);
}
.modal-content {
  background: white;
  padding: 20px;
  width: 320px;
  margin: 100px auto;
  border-radius: 6px;
}
input {
  width: 100%;
  padding: 6px;
  margin-bottom: 8px;
}
</style>
</head>

<body>
<div class="container">
  <h2>NSU CGPA Calculator</h2>

  <p><b>Semester GPA:</b> <span id="semGPA">0.00</span></p>
  <p><b>Total CGPA:</b> <span id="totalCGPA">0.00</span></p>

  <button onclick="openModal()">Add Course</button>

  <table>
    <thead>
      <tr>
        <th>Course</th>
        <th>Faculty</th>
        <th>Section</th>
        <th>Credit</th>
        <th>Marks</th>
        <th>Grade</th>
      </tr>
    </thead>
    <tbody id="courseTable"></tbody>
  </table>
</div>

<div class="modal" id="modal">
  <div class="modal-content">
    <h3>Add Course</h3>
    <input id="course" placeholder="Course Code">
    <input id="faculty" placeholder="Faculty Code">
    <input id="section" placeholder="Section">
    <input id="credit" type="number" placeholder="Credit">
    <input id="marks" type="number" placeholder="Marks">
    <button onclick="addCourse()">OK</button>
    <button onclick="closeModal()">Cancel</button>
  </div>
</div>

<script>
let courses = JSON.parse(localStorage.getItem("courses")) || [];

function gradeFromMarks(m) {
  if (m >= 90) return ["A", 4.0];
  if (m >= 85) return ["A-", 3.7];
  if (m >= 80) return ["B+", 3.3];
  if (m >= 75) return ["B", 3.0];
  if (m >= 70) return ["B-", 2.7];
  if (m >= 65) return ["C+", 2.3];
  if (m >= 60) return ["C", 2.0];
  if (m >= 50) return ["D", 1.0];
  return ["F", 0.0];
}

function openModal() {
  document.getElementById("modal").style.display = "block";
}

function closeModal() {
  document.getElementById("modal").style.display = "none";
}

function addCourse() {
  let marks = parseFloat(document.getElementById("marks").value);
  let [grade, point] = gradeFromMarks(marks);

  let course = {
    course: document.getElementById("course").value,
    faculty: document.getElementById("faculty").value,
    section: document.getElementById("section").value,
    credit: parseFloat(document.getElementById("credit").value),
    marks,
    grade,
    point
  };

  courses.push(course);
  localStorage.setItem("courses", JSON.stringify(courses));
  render();
  closeModal();
}

function render() {
  let table = document.getElementById("courseTable");
  table.innerHTML = "";

  let totalPoints = 0;
  let totalCredits = 0;

  courses.forEach(c => {
    let row = `<tr>
      <td>${c.course}</td>
      <td>${c.faculty}</td>
      <td>${c.section}</td>
      <td>${c.credit}</td>
      <td>${c.marks}</td>
      <td>${c.grade}</td>
    </tr>`;
    table.innerHTML += row;

    totalPoints += c.point * c.credit;
    totalCredits += c.credit;
  });

  let gpa = totalCredits ? (totalPoints / totalCredits).toFixed(2) : "0.00";
  document.getElementById("semGPA").innerText = gpa;
  document.getElementById("totalCGPA").innerText = gpa;
}

render();
</script>
</body>
</html>
